generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["dataproxy"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Gym {
  id        Int       @id @default(autoincrement())
  name      String
  address   String
  image_url String?
  site      String?
  Problem   Problem[]
  User      User?     @relation(fields: [userId], references: [id])
  userId    Int?
}

model Problem {
  id        Int      @id @default(autoincrement())
  gym_id    Int
  gym       Gym      @relation(fields: [gym_id], references: [id])
  setter_id Int
  setter    User     @relation(fields: [setter_id], references: [id])
  date      DateTime
  image_url String
  color     String
  gym_grade String
  hold_type String?
  wall_type String?
  style     String?
  Send      Send[]
  Like      Like[]
}

model User {
  id      Int       @id @default(autoincrement())
  email   String    @unique
  name    String
  Gym     Gym[]
  Problem Problem[]
  Send    Send[]
  Like    Like[]
}

model Send {
  problem_id Int
  problem    Problem  @relation(fields: [problem_id], references: [id])
  user_id    Int
  sender     User     @relation(fields: [user_id], references: [id])
  date       DateTime
  grade      String
  attempts   String

  @@id([problem_id, user_id])
}

model Like {
  problem_id Int
  problem    Problem @relation(fields: [problem_id], references: [id])
  user_id    Int
  user       User    @relation(fields: [user_id], references: [id])

  @@id([problem_id, user_id])
}
